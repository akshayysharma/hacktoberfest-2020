<audio id="theme1" src="AUDIO/Theme1.mp3" onended="theme1End()"></audio>
<body style="background-color:brown"onkeydown="keyDown(event)" onkeyup="keyUp(event)"> </body>
<canvas id="graphics" width=600 height=400 style="position:absolute;top:150;left:400;border:black 3px solid; background-color:blue;background-image:url('IMAGES/background.png');"> </canvas>

<script> 
//Variables
//    Audio
var theme1 = document.getElementById("theme1");
theme1.play();
function theme1End(){
	theme1.play();
}
var sndJump = new Audio ("AUDIO/Jump.mp3")
//     Rendering
var gameCanvas = document.getElementById("graphics");
var grafix = gameCanvas.getContext('2d');
var player = new Object('IMAGES/TempMario.png',150,100,32,44);
var startingBoundary = new Object('IMAGES/StartingWall.png',-665,0,800,400);
var pipe = new Object('IMAGES/Pipe.png',6400,260,32,40);
var flagpole = new Object('IMAGES/FlagPole.png',125*32,148,32,220);
var koopa1 = new Object('IMAGES/koopa.png',40*32,250,32,44);
var winscreen = new Object('IMAGES/VictoryScreen.png',-800,-800,500,300);
var losescreen = new Object('IMAGES/LosingScreen.png',-800,-800,500,300);
//Ground Layout
var maxBlock= 200;
var block = new Array();
for (var i=0;i<=maxBlock;i++) {
	block[i] = new Object('IMAGES/Ground.png',-600,600,32,32)
}
	block[1] = new Object('IMAGES/Ground.png',4*32,300,32,32);
	block[2] = new Object('IMAGES/Ground.png',5*32,300,32,32);
	block[3] = new Object('IMAGES/Ground.png',6*32,300,32,32);
	block[4] = new Object('IMAGES/Ground.png',7*32,300,32,32);
	block[5] = new Object('IMAGES/Ground.png',8*32,300,32,32);
	block[6] = new Object('IMAGES/Ground.png',9*32,300,32,32);
	block[7] = new Object('IMAGES/Ground.png',10*32,300,32,32);
	block[8] = new Object('IMAGES/Ground.png',11*32,300,32,32);
	block[9] = new Object('IMAGES/Ground.png',12*32,300,32,32);
	block[10] = new Object('IMAGES/Ground.png',13*32,300,32,32);
	
	block[11] = new Object('IMAGES/Ground.png',20*32,300,32,32);
	block[12] = new Object('IMAGES/Ground.png',21*32,300,32,32);
	block[13] = new Object('IMAGES/Ground.png',22*32,300,32,32);
	block[14] = new Object('IMAGES/Ground.png',23*32,300,32,32);
	block[15] = new Object('IMAGES/Ground.png',24*32,300,32,32);
	block[16] = new Object('IMAGES/Ground.png',25*32,300,32,32);
	block[17] = new Object('IMAGES/Ground.png',26*32,300,32,32);
	block[18] = new Object('IMAGES/Ground.png',27*32,300,32,32);
	
	block[19] = new Object('IMAGES/Ground.png',28*32,364,32,32);
	block[20] = new Object('IMAGES/Ground.png',29*32,364,32,32);
	block[21] = new Object('IMAGES/Ground.png',30*32,364,32,32);
	block[22] = new Object('IMAGES/Ground.png',31*32,364,32,32);
	block[23] = new Object('IMAGES/Ground.png',32*32,364,32,32);
	block[24] = new Object('IMAGES/Ground.png',33*32,364,32,32);
	block[25] = new Object('IMAGES/Ground.png',34*32,364,32,32);
	block[26] = new Object('IMAGES/Ground.png',35*32,364,32,32);
	block[27] = new Object('IMAGES/Ground.png',36*32,364,32,32);
	block[28] = new Object('IMAGES/Ground.png',37*32,364,32,32);
	block[29] = new Object('IMAGES/Ground.png',38*32,364,32,32);
	block[30] = new Object('IMAGES/Ground.png',39*32,364,32,32);
	block[31] = new Object('IMAGES/Ground.png',40*32,364,32,32);
	
	block[32] = new Object('IMAGES/Ground.png',44*32,268,32,32);
	block[33] = new Object('IMAGES/Ground.png',45*32,268,32,32);
	block[34] = new Object('IMAGES/Ground.png',46*32,268,32,32);
	block[35] = new Object('IMAGES/Ground.png',47*32,268,32,32);
	block[36] = new Object('IMAGES/Ground.png',48*32,268,32,32);
	block[37] = new Object('IMAGES/Ground.png',49*32,268,32,32);
	block[38] = new Object('IMAGES/Ground.png',50*32,268,32,32);
	block[39] = new Object('IMAGES/Ground.png',51*32,268,32,32);
	block[40] = new Object('IMAGES/Ground.png',52*32,268,32,32);
	block[41] = new Object('IMAGES/Ground.png',53*32,268,32,32);
	block[42] = new Object('IMAGES/Ground.png',54*32,268,32,32);
	block[43] = new Object('IMAGES/Ground.png',55*32,268,32,32);
	
	block[44] = new Object('IMAGES/Ground.png',109*32,368,32,32);
	block[45] = new Object('IMAGES/Ground.png',110*32,368,32,32);
	block[46] = new Object('IMAGES/Ground.png',111*32,368,32,32);
	block[47] = new Object('IMAGES/Ground.png',112*32,368,32,32);
	block[48] = new Object('IMAGES/Ground.png',113*32,368,32,32);
	block[49] = new Object('IMAGES/Ground.png',114*32,368,32,32);
	block[50] = new Object('IMAGES/Ground.png',115*32,368,32,32);
	block[51] = new Object('IMAGES/Ground.png',116*32,368,32,32);
	block[52] = new Object('IMAGES/Ground.png',117*32,368,32,32);
	block[53] = new Object('IMAGES/Ground.png',118*32,368,32,32);
	block[54] = new Object('IMAGES/Ground.png',119*32,368,32,32);
	block[55] = new Object('IMAGES/Ground.png',120*32,368,32,32);
	block[56] = new Object('IMAGES/Ground.png',121*32,368,32,32);
	block[57] = new Object('IMAGES/Ground.png',122*32,368,32,32);
	block[58] = new Object('IMAGES/Ground.png',123*32,368,32,32);
	block[59] = new Object('IMAGES/Ground.png',124*32,368,32,32);
	block[60] = new Object('IMAGES/Ground.png',125*32,368,32,32);
	block[61] = new Object('IMAGES/Ground.png',126*32,368,32,32);
	block[62] = new Object('IMAGES/Ground.png',127*32,368,32,32);
	block[63] = new Object('IMAGES/Ground.png',128*32,368,32,32);
	block[64] = new Object('IMAGES/Ground.png',129*32,368,32,32);
	block[65] = new Object('IMAGES/Ground.png',130*32,368,32,32);

var underBlock = new Array();
for (var i=0;i<=maxBlock;i++) {
	underBlock[i] = new Object('IMAGES/BelowGround.png',i*32,332,32,32);
}

var maxchancebox = 21;
var chancebox = new Array();
for (var i=0;i<=maxchancebox;i++) (
	 chancebox[i] = new Object('IMAGES/chancebox.png',-600,800,32,32)
)
	chancebox[1] = new Object('IMAGES/chancebox.png',6*32,200,32,32);
	chancebox[2] = new Object('IMAGES/chancebox.png',7*32,200,32,32);
	chancebox[3] = new Object('IMAGES/chancebox.png',8*32,200,32,32);
	chancebox[4] = new Object('IMAGES/chancebox.png',9*32,200,32,32);
	
	chancebox[5] = new Object('IMAGES/chancebox.png',23*32,200,32,32);
	chancebox[6] = new Object('IMAGES/chancebox.png',24*32,200,32,32);
	chancebox[7] = new Object('IMAGES/chancebox.png',25*32,200,32,32);
	
	chancebox[8] = new Object('IMAGES/chancebox.png',29*32,200,32,32);
	chancebox[9] = new Object('IMAGES/chancebox.png',30*32,200,32,32);
	chancebox[10] = new Object('IMAGES/chancebox.png',31*32,200,32,32);
	chancebox[11] = new Object('IMAGES/chancebox.png',32*32,200,32,32);
	chancebox[12] = new Object('IMAGES/chancebox.png',33*32,200,32,32);
	chancebox[13] = new Object('IMAGES/chancebox.png',34*32,200,32,32);
	chancebox[14] = new Object('IMAGES/chancebox.png',35*32,200,32,32);
	chancebox[15] = new Object('IMAGES/chancebox.png',36*32,200,32,32);
	
	chancebox[16] = new Object('IMAGES/chancebox.png',44*32,150,32,32);
	chancebox[17] = new Object('IMAGES/chancebox.png',45*32,150,32,32);
	chancebox[18] = new Object('IMAGES/chancebox.png',46*32,150,32,32);
	chancebox[19] = new Object('IMAGES/chancebox.png',47*32,150,32,32);
	chancebox[20] = new Object('IMAGES/chancebox.png',48*32,150,32,32);
	chancebox[21] = new Object('IMAGES/chancebox.png',49*32,150,32,32);
	
	
var maxplatform3w = 20;
var platform3w = new Array();
for (var i=0;i<=maxplatform3w;i++) (
	platform3w[i] = new Object('IMAGES/platform3w.png',-600,300,96,32)
)
	platform3w[2] = new Object('IMAGES/platform3w.png',59*32,268,96,32);
	platform3w[3] = new Object('IMAGES/platform3w.png',69*32,268,96,32);
	platform3w[4] = new Object('IMAGES/platform3w.png',79*32,268,96,32);
	platform3w[5] = new Object('IMAGES/platform3w.png',89*32,268,96,32);
	platform3w[6] = new Object('IMAGES/platform3w.png',98*32,236,96,32);

var maxplatform1w = 20;
var platform1w = new Array();
for (var i=0;i<=maxplatform1w;i++) (
	platform1w[i] = new Object('IMAGES/platform1w.png',-600,300,96,32)
)
	platform1w[1] = new Object('IMAGES/platform1w.png',113*32,336,96,32);
	platform1w[2] = new Object('IMAGES/platform1w.png',114*32,336,96,32);
	platform1w[3] = new Object('IMAGES/platform1w.png',114*32,304,96,32);
	platform1w[4] = new Object('IMAGES/platform1w.png',115*32,336,96,32);
	platform1w[5] = new Object('IMAGES/platform1w.png',115*32,304,96,32);
	platform1w[6] = new Object('IMAGES/platform1w.png',115*32,272,96,32);
	platform1w[7] = new Object('IMAGES/platform1w.png',116*32,336,96,32);
	platform1w[8] = new Object('IMAGES/platform1w.png',116*32,304,96,32);
	platform1w[9] = new Object('IMAGES/platform1w.png',116*32,272,96,32);
	platform1w[10] = new Object('IMAGES/platform1w.png',116*32,240,96,32);
	platform1w[11] = new Object('IMAGES/platform1w.png',117*32,336,96,32);
	platform1w[12] = new Object('IMAGES/platform1w.png',117*32,304,96,32);
	platform1w[13] = new Object('IMAGES/platform1w.png',117*32,272,96,32);
	platform1w[14] = new Object('IMAGES/platform1w.png',117*32,240,96,32);
	platform1w[15] = new Object('IMAGES/platform1w.png',117*32,208,96,32);
	
//       Control
var isLeft = false;
var isRight = false;
var isSpace = false;
player.Gravity = 20;
player.Weight = 0.1;

koopa1.Gravity = 20;
koopa1.Weight = 0.1;


//Events
function keyDown(e) {
	if (String.fromCharCode(e.keyCode) == "%") isLeft = true;
	if (String.fromCharCode(e.keyCode) == "'") isRight = true;
	if (String.fromCharCode(e.keyCode) == " ") isSpace = true;
	
}

function keyUp(e) {
	if (String.fromCharCode(e.keyCode) == "%") isLeft = false;
	if (String.fromCharCode(e.keyCode) == "'") isRight = false;
	if (String.fromCharCode(e.keyCode) == " ") isSpace = false;

}

//MainLoop
MainLoop();
function MainLoop() {

//Scroll Control
for (var i=0;i<=maxBlock;i++) block[i].X += -player.Velocity_X;
for (var i=0;i<=maxchancebox;i++) chancebox[i].X += -player.Velocity_X;
for (var i=0; i<=maxplatform3w;i++) platform3w[i].X += -player.Velocity_X;
for (var i=0; i<=maxplatform1w;i++) platform1w[i].X += -player.Velocity_X;
flagpole.X += - player.Velocity_X;
chancebox.X += -player.Velocity_X;
pipe.X += -player.Velocity_X;
startingBoundary.X += -player.Velocity_X;

koopa1.X += -0.8 -player.Velocity_X;
koopa1.Y += koopa1.Velocity_Y;
//Movement
player.Y += player.Velocity_Y
if (isLeft) player.Velocity_X = -3;
if (isRight) player.Velocity_X = 3;
if (!isLeft && !isRight && player.Velocity_Y== 0) player.Velocity_X = 0;
if (player.Velocity_Y < player.Gravity) player.Velocity_Y += player.Weight;

//Koopa
if (koopa1.Velocity_Y < koopa1.Gravity) koopa1.Velocity_Y += koopa1.Weight;
for (var i=0;i<=maxBlock;i++) {
if (koopa1.isColliding(block[i]) && koopa1.Y + koopa1.Height < block[i].Y + koopa1.Velocity_Y) {
	koopa1.Y = block[i].Y - koopa1.Height;
	koopa1.Velocity_Y = 0;

	}
}
if (koopa1.isColliding(startingBoundary) ) {
	koopa1.Velocity_X *= 0;
	koopa1.X +=1;
}
if (player.Y < koopa1.Y - 40 && player.isColliding(koopa1))
	koopa1.Y=600;
if (player.Y > (koopa1.Y - koopa1.Height)+40 && player.isColliding(koopa1))
	GameLost();

//Collisions
//					Ground Collisions
for (var i=0;i<=maxBlock;i++) {
var gc = block[i];
if (player.isColliding(gc) && player.Y + player.Height < gc.Y + player.Velocity_Y && Math.abs(((player.Y - gc.Y)/2))>8.1) {
	player.Y = gc.Y - player.Height;
	player.Velocity_Y = 0;
	continue;
}
else if (player.isColliding(gc) && player.X + player.Width > gc.X + gc.Width && Math.abs(((player.X - gc.X)/2))>8.1 && player.Y < gc.Y - player.Height) {
	player.X = gc.X + player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(gc) && player.X < gc.Width + gc.X && Math.abs(((player.X - gc.X)/2))>8.1 && player.Y < gc.Y - player.Height) {
	player.X = gc.X - player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(gc) && player.Y + player.Height + player.Velocity_Y > gc.Y + 10 && Math.abs(((player.Y - gc.Y)/2))>8.1) {
	player.Y = gc.Y + player.Height;
	player.Velocity_Y = 0;
	continue;
}
else player.isColliding(gc) == false;

}
//                  Platform3w Collisions
for (var i=0; i<=maxplatform3w; i++) {
var p3w = platform3w[i];
if (player.isColliding(p3w) && player.Y + player.Height < p3w.Y + player.Velocity_Y) {
	player.Y = p3w.Y - player.Height;
	player.Velocity_Y = 0;
	continue;
}
else if (player.isColliding(p3w) && player.X + player.Width > p3w.X + p3w.Width && Math.abs(((player.X - p3w.X)/2))>8.1) {
	player.X = p3w.X + player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(p3w) && player.X < p3w.Width + p3w.X && Math.abs(((player.X - p3w.X)/2))>8.1) {
	player.X = p3w.X - player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(p3w) && player.Y + player.Height + player.Velocity_Y > p3w.Y + 10) {
	player.Y = p3w.Y + player.Height;
	player.Velocity_Y = 0;
	continue;
}
else player.isColliding(p3w) == false;
}

//                  Platform1wCollisions
for (var i=0; i<=maxplatform1w; i++) {
var p1w = platform1w[i];
if (player.isColliding(p1w) && player.Y + player.Height < p1w.Y + player.Velocity_Y) {
	player.Y = p1w.Y - player.Height;
	player.Velocity_Y = 0;
	continue;
}
else if (player.isColliding(p1w) && player.X + player.Width > p1w.X + p1w.Width && Math.abs(((player.X - p1w.X)/2))>8.1) {
	player.X = p1w.X + player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(p1w) && player.X < p1w.Width + p1w.X && Math.abs(((player.X - p1w.X)/2))>8.1) {
	player.X = p1w.X - player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(p1w) && player.Y + player.Height + player.Velocity_Y > p1w.Y + 10) {
	player.Y = p1w.Y + player.Height;
	player.Velocity_Y = 0;
	continue;
}
else player.isColliding(p1w) == false;
}
//					Chancebox Collisions

for (var i=0; i<=maxchancebox; i++) {
if (player.isColliding(chancebox[i]) && player.Y + player.Height < chancebox[i].Y + player.Velocity_Y) {
	player.Y = chancebox[i].Y - player.Height;
	player.Velocity_Y = 0;
	continue;
}
else if (player.isColliding(chancebox[i]) && player.X + player.Width > chancebox[i].X + chancebox[i].Width && Math.abs(((player.X - chancebox[i].X)/2))>8.1) {
	player.X = chancebox[i].X + player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(chancebox[i]) && player.X < chancebox[i].Width + chancebox[i].X && Math.abs(((player.X - chancebox[i].X)/2))>8.1) {
	player.X = chancebox[i].X - player.Width;
	player.Velocity_X = 0;
	continue;
}
else if (player.isColliding(chancebox[i]) && player.Y + player.Height + player.Velocity_Y > chancebox[i].Y + 10) {
	player.Y = chancebox[i].Y + player.Height;
	player.Velocity_Y = 0;
	continue;
}
else player.isColliding(chancebox[i]) == false;
}

//					Starting Boundary Collisions
if (player.isColliding(startingBoundary)) {
	player.Velocity_X = 0.5;
}

if (isSpace && player.Velocity_Y == 0) {
	player.Velocity_Y = -5;
	sndJump.play();
	}
// FlagPole
var fp = flagpole
if (player.isColliding(fp) && player.Y + player.Height < fp.Y + player.Velocity_Y) {
	player.Y = fp.Y - player.Height;
	player.Velocity_Y = 0;
}
else if (player.isColliding(fp) && player.X + player.Width > fp.X + fp.Width && Math.abs(((player.X - fp.X)/2))>8.1) {
	player.Velocity_X = 0;
	player.Velocity_Y = 5;
	GameWon();
}
else if (player.isColliding(fp) && player.X < fp.Width + fp.X && Math.abs(((player.X - fp.X)/2))>8.1) {
	player.Velocity_X = 0;
	player.Velocity_Y = 5;
	GameWon();
}
else if (player.isColliding(fp) && player.Y + player.Height + player.Velocity_Y > fp.Y + 10) {
	player.Y = fp.Y + player.Height;
	player.Velocity_Y = 0;
}

//Losing The Game
if (player.Y > 400) {GameLost();}
//Winning The Game
if (player.X == pipe.X && player.Y - pipe.Y <= 8) { GameWon();}
//Rendering
grafix.clearRect(0,0,gameCanvas.width,gameCanvas.height);

for (var i=0;i<=maxBlock;i++) grafix.drawImage(block[i].Sprite,block[i].X,block[i].Y);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 32);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 64);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 96);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 128);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 160);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 192);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 224);
for (var i=0;i<=maxBlock;i++) grafix.drawImage(underBlock[i].Sprite,block[i].X,block[i].Y + 256);
for (var i=0;i<=maxchancebox;i++) grafix.drawImage(chancebox[i].Sprite,chancebox[i].X,chancebox[i].Y);
for (var i=0;i<=maxplatform3w;i++) grafix.drawImage(platform3w[i].Sprite,platform3w[i].X,platform3w[i].Y);
for (var i=0;i<=maxplatform1w;i++) grafix.drawImage(platform1w[i].Sprite,platform1w[i].X,platform1w[i].Y);
grafix.drawImage(koopa1.Sprite,koopa1.X,koopa1.Y);
grafix.drawImage(startingBoundary.Sprite,startingBoundary.X,startingBoundary.Y);
grafix.drawImage(pipe.Sprite,pipe.X,pipe.Y);
grafix.drawImage(flagpole.Sprite,flagpole.X,flagpole.Y);
grafix.drawImage(player.Sprite,player.X,player.Y);
grafix.drawImage(losescreen.Sprite,losescreen.X,losescreen.Y);
grafix.drawImage(winscreen.Sprite,winscreen.X,winscreen.Y);

//End MainLoop
setTimeout(MainLoop,1000/60);
}

//GameLost
function GameLost() {
losescreen = new Object('IMAGES/LosingScreen.png',25,25,500,300);
}

//GameWon
function GameWon() {
winscreen = new Object('IMAGES/VictoryScreen.png',25,25,500,300);
}
//Object Class
function Object(img,x,y,width,height) {
this.Sprite = new Image();
this.Sprite.src = img;
this.X = x;
this.Y = y;
this.Width = width;
this.Height = height;
this.Previous_X;
this.Previous_Y;
this.Velocity_X = 0;
this.Velocity_Y = 0;
this.Gravity = 0;
this.Weight = 0;



//Collisions (A Part of Object Class)

this.isColliding = function(obj) {
	if (this.X > obj.X + obj.Width) return false;
	if (this.X + this.Width < obj.X) return false;
	if (this.Y > obj.Y + obj.Height) return false;
	if (this.Y + this.Height < obj.Y) return false;
	return true;
	}
}
</script>
